{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c32dc4f6_b9ef215f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003571
      },
      "writtenOn": "2021-10-13T14:02:00Z",
      "side": 1,
      "message": "Hmm, as unintuitive as it is, this looks right. I think the link should actually be in a utf8str which has len \u003d\u003d strlen but the buffer size is +1 for a terminating NUL. That would be a more invasive fix but might be worthwhile.",
      "revId": "2d8ed58e626daf0eb25a5a8c868d3261048f7a68",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "37cbeddd_11fcc78f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1015854
      },
      "writtenOn": "2021-10-13T20:57:39Z",
      "side": 1,
      "message": "I\u0027ve tested this extensively and it works. With a linux kernel client, it even mostly worked before, except for directories with NFSv4 style junctions (NetApp, I\u0027m looking at you). That\u0027s how we found the bug.\n\nI have a lot of changes in flight at the moment. Can we accept this now, and do the utf8str change later?",
      "parentUuid": "c32dc4f6_b9ef215f",
      "revId": "2d8ed58e626daf0eb25a5a8c868d3261048f7a68",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "68b21662_936a5df3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003571
      },
      "writtenOn": "2021-10-13T23:44:39Z",
      "side": 1,
      "message": "Tell me more about mostly worked before. Do we need the NUL to go over the wire?",
      "parentUuid": "37cbeddd_11fcc78f",
      "revId": "2d8ed58e626daf0eb25a5a8c868d3261048f7a68",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2142bace_91afc419",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1004087
      },
      "writtenOn": "2021-10-14T13:58:40Z",
      "side": 1,
      "message": "I checked a couple of other FSALs and they do this too, so I think this is correct.",
      "parentUuid": "68b21662_936a5df3",
      "revId": "2d8ed58e626daf0eb25a5a8c868d3261048f7a68",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e1649133_a4da7119",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003571
      },
      "writtenOn": "2021-10-15T17:00:09Z",
      "side": 1,
      "message": "OK, will take as is. I\u0027m going to open an issue to make the change to utf8str",
      "parentUuid": "2142bace_91afc419",
      "revId": "2d8ed58e626daf0eb25a5a8c868d3261048f7a68",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "20bad7d1_7cd98818",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1015854
      },
      "writtenOn": "2021-10-17T08:29:37Z",
      "side": 1,
      "message": "(Forgot to respond before the weekend, sorry for the late reply)\n\nThis mostly worked in my simple testing, as in I never noticed any problems. Then someone else tried to use it with NetApp backends. Those backends were configured with lots of volumes and the NetApp special feature of junctions in NFSv3. When we looked into the protocol, the null terminator needed to go over the wire. The NetApp NFSv3 junctions didn\u0027t work without the null terminator.\n\nfsal_api.h says that for readlink():\n * The symlink content passed back *must* be null terminated and the\n * length indicated in the buffer description *must* include the\n * terminator.",
      "parentUuid": "e1649133_a4da7119",
      "revId": "2d8ed58e626daf0eb25a5a8c868d3261048f7a68",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}